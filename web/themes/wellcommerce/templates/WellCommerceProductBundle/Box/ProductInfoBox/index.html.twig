{% trans_default_domain "wellcommerce" %}

<div class="product-details">
    <div class="row">
        <div class="col-md-9 col-xs-12">
	        <div class="col-sm-5 col-xs-12 text-center">
		            {% set productPhotos = product.getProductPhotos() %}

					{% for photo in product.productPhotos if photo.mainPhoto == 1 %}
	                <a href="#" class="mainphoto"><img src="{{ image(photo.photo.path, 'large') }}" /></a>
					{% endfor %}

		            <div class="thumbnails">
		                {% for photo in product.productPhotos if photo.mainPhoto == 0 %}
		                    <a href="#"><img src="{{ image(photo.photo.path, 'large') }}" /></a>
		                {% endfor %}
		            </div>
	        </div>
	        <div class="col-sm-7 col-xs-12">
	            <div class="description">
	                <div class="controls clearfix">
	                    <a href="#" class="pull-left coming-soon">Previous product</a>
	                    <a href="#" class="pull-right coming-soon">Next product</a>
	                </div>

	                <h1>{{ product.translate().name }}</h1>

	                <div class="reviews">
	                	<!--
	                		Klasa rat* np. "rat3" to powierzchnia zakolorowanej ostatniej zółtej gwiazdki, np. w tym wypadku zakolorowana będzie 30%
	                	-->
	                    <div class="stars rat rat5">
	                        <span ><img src="{{ asset('themes/wellcommerce/assets/img/star-on.png') }}" /></span>
	                        <span><img src="{{ asset('themes/wellcommerce/assets/img/star-on.png') }}" /></span>
	                        <span><img src="{{ asset('themes/wellcommerce/assets/img/star-on.png') }}" /></span>
	                        <span class="not-quite-full"><img src="{{ asset('themes/wellcommerce/assets/img/star-on.png') }}" /></span>
	                        <span><img src="{{ asset('themes/wellcommerce/assets/img/star-off.png') }}" /></span>
	                    </div>

	                    <span>4.3 / see 12 reviews</span>
	                </div>

	                <p>{{ product.translate().shortDescription|striptags }}</p>

	                <div class="row">
	                    <div class="col-sm-6 col-xs-6">
	                        <div class="delivery-info">
	                            <h5>{% trans %}product.label.shipping_cost{% endtrans %}</h5>
	                            {% for shipping in shippingCosts %}
	                            <span>{{ shipping.shippingMethod.translate().name }} {{ format_price(shipping.cost.grossAmount, shipping.cost.currency) }}</span>
	                            {% endfor %}
	                        </div>
	                    </div>
	                    <div class="col-md-4 col-sm-5 col-xs-6 col-lg-offset-2 col-md-offset-2 col-sm-offset-1">
	                        <div class="producer">
	                            <h5>Producer</h5>

	                            <a href="{{ path('dynamic_' ~ product.getProducer().translate.getRoute().getId()) }}"><img src="{{ asset('themes/wellcommerce/assets/prod/producer.png') }}" /></a>
	                        </div>
	                    </div>
	                </div>
	            </div>
	        </div>
        </div>
        <div class="col-md-3 col-xs-12">
            <div class="add-to-cart">
                {% if product.sellPrice.isDiscountValid() %}
                    <span class="price promo">
                        <small id="price">{{ format_price(product.sellPrice.grossAmount, product.sellPrice.currency) }}</small>
                        <span>{{ format_price(product.sellPrice.discountedGrossAmount, product.sellPrice.currency) }}</span>
                    </span>
                    <div class="labels">
                        <span class="label label-promotion">Promotion</span>
                    </div>
                {% else %}
                    <span class="price" id="price">
                        {{ format_price(product.sellPrice.grossAmount, product.sellPrice.currency) }}
                    </span>
                {% endif %}

                <div class="available text-center">
                    {% trans %}product.label.availability{% endtrans %}: <span class="grn">{{ product.availability.translate().name }}</span><br />
                    {% if shippingCosts.count > 0 %}
                        {% trans %}product.label.shipping_cost{% endtrans %}: {{ format_price(shippingCosts.first.cost.grossAmount, shippingCosts.first.cost.currency) }}
                    {% endif %}
                </div>
                {% include 'WellCommerceProductBundle:Front/Common:add_cart_form.html.twig' %}
            </div>

            <div class="additional text-center">
                {% if app.user and is_granted('ROLE_CLIENT') %}
                <a href="{{ path('front.client_wishlist.add', {"id": product.id}) }}">Add to wishlist</a><br />
                {% endif %}
                <a href="#" class="coming-soon">Add to compare</a>
            </div>
        </div>
    </div>
</div>

<div class="product-description">
    <div class="row">
        <div class="col-md-9 col-xs-12">
            <div class="description-block">
                <h2>Description</h2>
                <p>{{ product.translate().description }}</p>
            </div>

            <div class="description-block">
                <h2>Opinions</h2>

                <div id="add-opinion-alert" class="alert alert-success">
                    <button class="btn btn-success btn-lg pull-right">Add opinion</button>
                    <strong>Help others decide - add rating and review</strong><br />
                    Your rating will help others decide to choose the right product
                </div>

                <!-- OPINION ADDED ALERT
                <div class="alert alert-info">
					<strong>Your review has been sent and is awaiting moderation.</strong>
				</div>
				-->

				<div class="well product-opinions collapse">
					<form class="form-horizontal">
						<div class="form-group">
							<label for="nick" class="col-sm-3 control-label">Your rating</label>
							<div class="col-md-6 col-sm-10">
								<div class="stars">
			                        <img src="{{ asset('themes/wellcommerce/assets/img/star-off.png') }}" />
			                        <img src="{{ asset('themes/wellcommerce/assets/img/star-off.png') }}" />
			                        <img src="{{ asset('themes/wellcommerce/assets/img/star-off.png') }}" />
			                        <img src="{{ asset('themes/wellcommerce/assets/img/star-off.png') }}" />
			                        <img src="{{ asset('themes/wellcommerce/assets/img/star-off.png') }}" />
			                    </div>
							</div>
						</div>
						<div class="form-group">
							<label for="nick" class="col-sm-3 control-label">Your name</label>
							<div class="col-md-6 col-sm-10">
								<input type="text" class="form-control" id="nick">
							</div>
						</div>
						<div class="form-group">
							<label for="opinion" class="col-sm-3 control-label">Your opinion</label>
							<div class="col-md-6  col-sm-10">
								<textarea class="form-control" rows="3"></textarea>
							</div>
						</div>
						<div class="form-group">
							<div class="col-sm-offset-3 col-md-6 col-sm-10">
								<button type="submit" class="btn btn-primary">Add opinion</button>
							</div>
						</div>
					</form>
				</div>

				<div class="media product-opinion">
					<div class="media-left">
						<span class="glyphicon glyphicon-comment" aria-hidden="true"></span>
					</div>
					<div class="media-body">
						<h4 class="media-heading">
							Adrian
							<small>11-11-2015</small>
						</h4>

						<div>
							<span class="glyphicon glyphicon-star" aria-hidden="true"></span>
							<span class="glyphicon glyphicon-star" aria-hidden="true"></span>
							<span class="glyphicon glyphicon-star" aria-hidden="true"></span>
							<span class="glyphicon glyphicon-star" aria-hidden="true"></span>
							<span class="glyphicon glyphicon-star" aria-hidden="true"></span>
						</div>

						Cras sit amet nibh libero, in gravida nulla. Nulla vel metus scelerisque ante sollicitudin commodo.
					</div>
				</div>


				<div class="media product-opinion">
					<div class="media-left">
						<span class="glyphicon glyphicon-comment" aria-hidden="true"></span>
					</div>
					<div class="media-body">
						<h4 class="media-heading">
							Adam
							<small>17-10-2015</small>
						</h4>

						<div>
							<span class="glyphicon glyphicon-star" aria-hidden="true"></span>
							<span class="glyphicon glyphicon-star-empty" aria-hidden="true"></span>
							<span class="glyphicon glyphicon-star-empty" aria-hidden="true"></span>
							<span class="glyphicon glyphicon-star-empty" aria-hidden="true"></span>
							<span class="glyphicon glyphicon-star-empty" aria-hidden="true"></span>
						</div>

						Nulla vel metus scelerisque ante sollicitudin commodo.
					</div>
				</div>

				<div class="media product-opinion">
					<div class="media-left">
						<span class="glyphicon glyphicon-comment" aria-hidden="true"></span>
					</div>
					<div class="media-body">
						<h4 class="media-heading">
							Michał
							<small>21-05-2015</small>
						</h4>

						<div>
							<span class="glyphicon glyphicon-star" aria-hidden="true"></span>
							<span class="glyphicon glyphicon-star" aria-hidden="true"></span>
							<span class="glyphicon glyphicon-star" aria-hidden="true"></span>
							<span class="glyphicon glyphicon-star-empty" aria-hidden="true"></span>
							<span class="glyphicon glyphicon-star-empty" aria-hidden="true"></span>
						</div>

						ras purus odio, vestibulum in vulputate at, tempus viverra turpis.
					</div>
				</div>

				<div class="media product-opinion">
					<div class="media-left">
						<span class="glyphicon glyphicon-comment" aria-hidden="true"></span>
					</div>
					<div class="media-body">
						<h4 class="media-heading">
							Rafał
							<small>08-01-2015</small>
						</h4>

						<div>
							<span class="glyphicon glyphicon-star" aria-hidden="true"></span>
							<span class="glyphicon glyphicon-star" aria-hidden="true"></span>
							<span class="glyphicon glyphicon-star" aria-hidden="true"></span>
							<span class="glyphicon glyphicon-star" aria-hidden="true"></span>
							<span class="glyphicon glyphicon-star-empty" aria-hidden="true"></span>
						</div>

						Fusce condimentum nunc ac nisi vulputate fringilla. Donec lacinia congue felis in faucibus.
					</div>
				</div>


            </div>
        </div>
        <div class="col-md-3 hidden-sm hidden-xs">
            {% include 'WellCommerceCmsBundle:Front/Common:sidebar_contact.html.twig' %}
        </div>
    </div>
</div>

<script type="text/javascript">
    $(document).ready(function(){
        $('.product-details .add-to-cart').GProductAddCartForm({
            sAddProductRoute: 'front.cart.add',
            oProduct: $('#product', $(this)),
            oQuantity: $('#quantity', $(this)),
            oAttribute: $('#attribute', $(this)),
            oPrice: $('#price', $(this)),
            oBasketModal: $('#basket-modal'),
            oCartPreview: $('#topCart'),
            sAttributesSelectClass: '.attribute',
            aoAttributes: {{ attributes|raw }}
        });

        $('#add-opinion-alert > button').click(function(){
	    	$('.product-opinions').addClass('in');
	    	$('#add-opinion-alert').hide();
        });
    });
</script>
